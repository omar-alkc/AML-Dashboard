<div *ngIf="!loading" class="kpis-container">
  <!-- Total KPIs Row -->
  <div class="kpis-section">
    <h4 class="section-title">Total Transactions</h4>
    <div class="row">
      <div class="col-md-6" *ngFor="let kpi of totalKpis">
        <nb-card [status]="kpi.status" class="kpi-card">
          <nb-card-body>
            <div class="kpi-content">
              <div class="kpi-icon">
                <nb-icon [icon]="kpi.icon"></nb-icon>
              </div>
              <div class="kpi-details">
                <div class="kpi-title">{{ kpi.title }}</div>
                <div class="kpi-value">{{ kpi.value | number }}</div>
                <div *ngIf="kpi.comparison" class="kpi-comparison" 
                     [ngClass]="{'positive': kpi.comparison.isPositive, 'negative': !kpi.comparison.isPositive, 'neutral': kpi.comparison.isNeutral}">
                  <nb-icon [icon]="kpi.comparison.isNeutral ? 'minus-outline' : (kpi.comparison.isPositive ? 'arrow-up-outline' : 'arrow-down-outline')"></nb-icon>
                  <span>{{ kpi.comparison.percentageChange }}% vs previous period</span>
                </div>
              </div>
            </div>
          </nb-card-body>
        </nb-card>
      </div>
    </div>
  </div>

  <!-- Average KPIs Row -->
  <div class="kpis-section">
    <h4 class="section-title">Average Transactions</h4>
    <div class="row">
      <div class="col-md-6" *ngFor="let kpi of averageKpis">
        <nb-card [status]="kpi.status" class="kpi-card">
          <nb-card-body>
            <div class="kpi-content">
              <div class="kpi-icon">
                <nb-icon [icon]="kpi.icon"></nb-icon>
              </div>
              <div class="kpi-details">
                <div class="kpi-title">{{ kpi.title }}</div>
                <div class="kpi-value">{{ kpi.value | number }}</div>
                <div *ngIf="kpi.comparison" class="kpi-comparison" 
                     [ngClass]="{'positive': kpi.comparison.isPositive, 'negative': !kpi.comparison.isPositive, 'neutral': kpi.comparison.isNeutral}">
                  <nb-icon [icon]="kpi.comparison.isNeutral ? 'minus-outline' : (kpi.comparison.isPositive ? 'arrow-up-outline' : 'arrow-down-outline')"></nb-icon>
                  <span>{{ kpi.comparison.percentageChange }}% vs previous period</span>
                </div>
              </div>
            </div>
          </nb-card-body>
        </nb-card>
      </div>
    </div>
  </div>

  <!-- Max KPIs Row -->
  <div class="kpis-section">
    <h4 class="section-title">Maximum Transactions</h4>
    <div class="row">
      <div class="col-md-6" *ngFor="let kpi of maxKpis">
        <nb-card [status]="kpi.status" class="kpi-card">
          <nb-card-body>
            <div class="kpi-content">
              <div class="kpi-icon">
                <nb-icon [icon]="kpi.icon"></nb-icon>
              </div>
              <div class="kpi-details">
                <div class="kpi-title">{{ kpi.title }}</div>
                <div class="kpi-value">{{ kpi.value | number }}</div>
                <div *ngIf="kpi.comparison" class="kpi-comparison" 
                     [ngClass]="{'positive': kpi.comparison.isPositive, 'negative': !kpi.comparison.isPositive, 'neutral': kpi.comparison.isNeutral}">
                  <nb-icon [icon]="kpi.comparison.isNeutral ? 'minus-outline' : (kpi.comparison.isPositive ? 'arrow-up-outline' : 'arrow-down-outline')"></nb-icon>
                  <span>{{ kpi.comparison.percentageChange }}% vs previous period</span>
                </div>
              </div>
            </div>
          </nb-card-body>
        </nb-card>
      </div>
    </div>
  </div>
</div>

<div *ngIf="loading" class="loading-container">
  <nb-spinner status="primary"></nb-spinner>
</div>

